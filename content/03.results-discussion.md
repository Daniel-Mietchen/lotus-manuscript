## Results & Discussion {.page_break_before}

### Outline of the LOTUS Blueprint

Building on the standards established by each related Wikidata projects (chemistry (Wikidata:WikiProject Chemistry), taxonomy (Wikidata:WikiProject Taxonomy), and source metadata (Wikidata:WikiProject Source MetaData)), a NP chemistry oriented subproject was created (Wikidata:WikiProject Chemistry/Natural products). Its central data is constituted of 3 minimal sufficient objects: 

- A chemical compound object, with associated Simplified Molecular Input Line Entry System (SMILES) (Weininger, 1988), International Chemical Identifier (InChI) (Heller et al., 2013), and InChIKey (a hashed version of the InChI).
- A biological organism object, with associated taxon name, the taxonomic DB where it was described, and the taxon ID in this DB.
- A reference object describing the structure-organism pair, with the associated article title and a Digital Object Identifier (DOI), a PubMed ID (PMID), or a PubMed Central ID (PMCID).

As data formats are largely inhomogeneous among existing NP DB, fields related to chemical structure, biological organism, and literature reference are variable and essentially not standardized. Therefore, LOTUS implements multiple steps of collection, harmonization, curation, and dissemination (Figure 1, stages 1 to 3). LOTUS employs the Single Source of Truth approach (SSOT, Single_source_of_truth) to ensure data reliability and continuous availability of the latest curated version of LOTUS data in both Wikidata and LNPN. The SSOT approach consists of a PostgreSQL DB structuring links and data schema so that every data element is in a single place. To accommodate the addition of data directly from new data sources or at the Wikidata level), LOTUS’ processing pipeline is tailored to efficiently include and diffuse novel or curated data (Figure 1, stage 4). This iterative workflow relies both on data addition and retrieval actions described in the Data Interaction section. The overall process leading to referenced and curated structure-organisms pairs is illustrated in Figure 1 and detailed below.

![**LOTUS process
overview**. The process consists of three main steps: Collection and Harmonization (1), Curation (2) and Dissemination (3). The process was designed to incorporate future contributions (4) either in the form of new data addition (a and b) or via curation of existing data (c). This an iterative process that allows the community to participate in the global effort to document NP occurrences (“virtuous circle”).
](images/workflow.svg "Workflow"){#fig:workflow}

All steps of the process are described in the https://gitlab.com/lotus7 project and at https://github.com/mSorok/LOTUSweb. At the time of submission, over 742,000 LOTUS entries contained a curated chemical structure, biological organism, and reference and are available on both Wikidata and LNPN. As the LOTUS data volume is expected to increase over time, a frozen (as of 2021-02-23) tabular version of this dataset with its associated metadata is made available at https://osf.io/hgjdb/.

### Data Harmonization

Initial data was collected from COCONUT and complemented with data sources described hereafter. All publicly accessible DB in COCONUT containing referenced structure-organism pairs were used. They were complemented with COCONUT’s own structure-organism documented pairs (Sorokina and Steinbeck, 2020a) and the following additional DB: Dr. Duke (“U.S. Department of Agriculture, Agricultural Research Service. Dr. Duke’s Phytochemical and Ethnobotanical Databases.,” 1992), Cyanometdb (Jones et al., 2020), Datawarrior (López-López et al., 2019), a subset of NAPRALERT (Graham and Farnsworth, 2010), Wakankensaku (“Main Page - WAKANKENSAKU,” n.d.), and DiaNat-DB (Madariaga-Mazón, 2021). The owners of the DB not explicitly licensed as open were individually contacted for permission to access and reuse data. The complete list of data sources and related information is available as SI-1. All necessary scripts for collection and harmonization can be found in the lotusProcessor repository in the src/1_gathering directory. All subsequent iterations with additional data sources (either the updated versions of the same data sources or new ones), will start by comparing the new data sources with previously collected ones at the SSOT level to curate data only once.

### Data Cleaning & Vaidation

As described in Figure 1, the data curation process was divided into three stages: harmonization, cleaning, and validation. Cleaning of each of the three central objects (chemical, biological, and reference) of the referenced pairs was performed. Given the data size with over 2.5M initial entries, manual validation was unfeasible. Curating the references turned out to be a particularly problematic point of the process. Whereas organisms are typically reported by at least their vernacular or scientific denomination and structures by their SMILES, InChI, InChIKey, or image (case not covered in this work), references suffer from largely insufficient reporting standards. Better reporting, together with new tools, such as Scholia (Nielsen et al., 2017; Rasberry et al., 2019), relying on Wikidata, Fatcat, or Semantic Scholar should lead towards improved references-related information retrieval in the future. Despite the poor standardization of the initial reference field, this latter is the only way to establish the validity of the structure-organism pair. Therefore, in addition to the entries curated during data processing, 420 referenced structure-organism pairs were analyzed manually to establish rules for automatic filtering of the entries. This filter was then applied to all entries. To confirm the efficacy of the filtering process, a subset of 100 diverse automatically curated and validated entries was manually checked, and showed a rate of 97% of true positives. The detailed results of the two manual validation steps are reported in Supporting Information SI-2. The resulting data is also available in the dataset shared at https://osf.io/hgjdb/.

| | Structure | Organism | Reference | 
|:--------:|:-------------:|:-------------:|:-------------:|
| **Before curation** | Cyathocaline | Stem bark of Cyathocalyx zeylanica CHAMP. ex HOOK. f. & THOMS. (Annonaceae) | Wijeratne E. M. K., de Silva L. B., Kikuchi T., Tezuka Y., Gunatilaka A. A. L., Kingston D. G. I., J. Nat. Prod., 58, 459-462 (1995). | 
| **After curation** |  VFIIVOHWCNHINZ-UHFFFAOYSA-N | Cyathocalyx zeylanicus | 10.1021/NP50117A020 | 

Table: Example of a given referenced structure-organism pair before and after curation {#tbl:examples}

Table 1 shows an example of a referenced structure-organism pair before and after curation, which resolved the structure to an InChIKey, the organism to a valid taxonomic name, and the reference to a DOI. Challenging examples encountered during the development of the curation process were compiled in an edge case table (tests/tests.tsv) to allow for automatic unit testing. These tests allow a continuous revalidation of any change made to the code, ensuring that no corrected error can reappear.

![**Alluvial plot of the LOTUS data flux during the automated curation and validation
process**: it represents the relative proportion of individual entries’ data streams and repartition by database (source database block), their harmonized subcategories for curation (original subcategory block), and their final validation status (cleaned category block). Automatically validated entries are represented in green and rejected ones in blue.
](images/alluvial.svg "Alluvial"){#fig:alluvial}

The alluvial plot in Figure 2 illustrates the individual contribution of each curated DB and original subcategory to the cleaned structure, organism, and reference categories. For example, the high contribution of NAPRALERT and UNPD is highlighted. In particular, the important contribution of the DOI category of references to the validated references by these two data sources is visible. The combination of the results of the automated curation pipeline and the manually curated entries led to the establishment of four categories (manually validated, manually rejected, automatically validated, and automatically rejected) of the documented structure-organism pairs that formed the processed part of the SSOT. Out of a total of more than 2M pairs, the manual and automatic validation retained 740,000+ pairs (~30 %), which were then selected for dissemination on Wikidata. The disseminated data contains 250,000+ unique chemical structures, 30,000+ distinct organisms, and 75,000+ references.

### Data Dissemination

Researchers should benefit from all results of published scientific studies immediately upon publication. This is considered as the foundation of scientific investigation and a prerequisite for effectively directing new research efforts based on prior available information. To achieve this, research results have to be made publicly available and reusable. As computers are now the main instrument of any scientist, data needs to be computer-readable and publications should be organized and summarized in a DB-compatible form. LOTUS employs Wikidata as the repository for the referenced structure-organism pairs as this enables the documented research data to be integrated with a pre-existing vast body of chemical and biological knowledge. The flexibility of Wikidata’s SPARQL language and the many other Wikidata resources allows users to efficiently query and retrieve data. Moreover, the dynamic nature of the Wikidata platform fosters the continuous curation of deposited data through its user communities. Independence from institutional funding represents another major advantage of integrating LOTUS into Wikidata.
At the same time, certain limitations of this approach can be anticipated. Despite their power, SPARQL queries are complex and often require a relatively in-depth understanding of the models and data structure. This involves a steep learning curve and can discourage end-users. Furthermore, traditional ways to query NP DB such as structural or spectral searches are currently not within the scope of Wikidata. Using the pre-existing COCONUT DB template, LNPN facilitates structure-based searches. It addresses the shortcomings of the current lack of structural searches in Wikidata for the community. 
Wikidata knowledge base and the option to use elaborated SPARQL queries allow to explore the dataset from a sheer unlimited number of angles. The openness of Wikidata also offers unique opportunities for community curation, which will support, if not guarantee, a dynamic and evolving data repository. On the other hand, LNPN hosting allows the user to perform structural searches in a more classical way, e.g., by drawing a molecule. Future versions of LOTUS and COCONUT are envisioned to be augmented by predicted MS spectra and are expected to be hosted at the naturalproducts.net portal to allow mass, fragment, and spectral-based queries.
To facilitate queries focused on specific taxa (e.g., “return all molecules found in the Asteraceae family”), a unified taxonomy is paramount. As the taxonomy of living organisms is a complex and always evolving field, all the taxon identifiers from all accepted taxonomic DB for a given taxon name were kept. This implies that for a given name, multiple taxonomies from different taxonomic DB are allowed. Initiatives such as the Open Tree of Life (OTL) (Rees and Cranston, 2017) will help to gradually reduce these discrepancies, the Wikidata platform should support this development. OTL also benefits from regular expert curation and new data. As the taxonomic identifier property for this database did not exist in Wikidata, its creation was requested and obtained (P9157). Following the previously described curation process, all validated entries have been made available through Wikidata and LNPN. LNPN will be regularly mirroring Wikidata LOTUS through the SSOT as described in Figure 1. 
Researchers should benefit from all results of published scientific studies immediately upon publication. This is considered as the foundation of scientific investigation and a prerequisite for effectively directing new research efforts based on prior available information. To achieve this, research results have to be made publicly available and reusable. As computers are now the main instrument of any scientist, data needs to be computer-readable and publications should be organized and summarized in a DB-compatible form. LOTUS employs Wikidata as the repository for the referenced structure-organism pairs as this enables the documented research data to be integrated with a pre-existing vast body of chemical and biological knowledge. The flexibility of Wikidata’s SPARQL language and the many other Wikidata resources allows users to efficiently query and retrieve data. Moreover, the dynamic nature of the Wikidata platform fosters the continuous curation of deposited data through its user communities. Independence from institutional funding represents another major advantage of integrating LOTUS into Wikidata.
At the same time, certain limitations of this approach can be anticipated. Despite their power, SPARQL queries are complex and often require a relatively in-depth understanding of the models and data structure. This involves a steep learning curve and can discourage end-users. Furthermore, traditional ways to query NP DB such as structural or spectral searches are currently not within the scope of Wikidata. Using the pre-existing COCONUT DB template, LNPN facilitates structure-based searches. It addresses the shortcomings of the current lack of structural searches in Wikidata for the community. 
Wikidata knowledge base and the option to use elaborated SPARQL queries allow to explore the dataset from a sheer unlimited number of angles. The openness of Wikidata also offers unique opportunities for community curation, which will support, if not guarantee, a dynamic and evolving data repository. On the other hand, LNPN hosting allows the user to perform structural searches in a more classical way, e.g., by drawing a molecule. Future versions of LOTUS and COCONUT are envisioned to be augmented by predicted MS spectra and are expected to be hosted at the naturalproducts.net portal to allow mass, fragment, and spectral-based queries.
To facilitate queries focused on specific taxa (e.g., “return all molecules found in the Asteraceae family”), a unified taxonomy is paramount. As the taxonomy of living organisms is a complex and always evolving field, all the taxon identifiers from all accepted taxonomic DB for a given taxon name were kept. This implies that for a given name, multiple taxonomies from different taxonomic DB are allowed. Initiatives such as the Open Tree of Life (OTL) (Rees and Cranston, 2017) will help to gradually reduce these discrepancies, the Wikidata platform should support this development. OTL also benefits from regular expert curation and new data. As the taxonomic identifier property for this database did not exist in Wikidata, its creation was requested and obtained (P9157). Following the previously described curation process, all validated entries have been made available through Wikidata and LNPN. LNPN will be regularly mirroring Wikidata LOTUS through the SSOT as described in Figure 1. 

### Data Interaction from the User Point-of-view

With the data being available in multiple formats, the possibilities to interact with the LOTUS data are numerous. Some basic and more advanced examples on how to retrieve, add and edit LOTUS data are provided hereafter.

#### Data Retrieval

LOTUS data can be queried and retrieved either on Wikidata directly or on LNPN, both of these options presenting unique advantages. Wikidata offers modularity at the cost of potentially complex access to the data. LNPN offers a Graphical User Interface (GUI) with chemical structure drawing possibility, easy structural or biological filtering, and advanced chemical descriptors, but with a more rigid structure. A frozen (2021-02-23) version of LOTUS data is available at https://osf.io/hgjdb/. Hereafter, finer approaches to directly interrogate the up-to-date LOTUS data both in Wikidata and LNPN are detailed.

##### Wikidata

The simplest way to search for NP occurrence information in Wikidata is by typing directly the name of a chemical structure in the “Search Wikidata'' field. For example by typing “erysodine” the user lands on the Wikidata page of this compound (Q27265641). Scrolling down to the “found in taxon” statement gives a view of the biological organisms reported to contain this chemical compound. Under each taxon name, clicking on the reference link will then display the scientific publication documenting the occurrence.

![**Illustration of the “found in taxon” statement section on the Wikidata
page** of erysodine [Q27265641](https://www.wikidata.org/wiki/Q27265641) showing a selection of containing taxa and the references documenting these occurrences.
](images/erysodine.png "wdpage"){#fig:wdpage}

For more elaborated queries, the most efficient way is to write SPARQL queries using the Wikidata Query Service or a direct connection to the SPARQL endpoint. Below are some examples, from simple to more elaborated queries demonstrating what can be done using this approach.

| Question | Wikidata SPARQL query | 
|:------------------------:|:-------------:|
| What are the compounds present in Mouse-ear cress (*Arabidopsis thaliana*)? | [https://w.wiki/32y8](https://w.wiki/32y8) | 
| Which organisms are known to contain compounds sharing the planar structure of β-sitosterol? | [https://w.wiki/334q](https://w.wiki/334q)  | 
| Which organisms are known to contain stereoisomers of β-sitosterol? | [https://w.wiki/334s](https://w.wiki/334s) | 
| Which pigments are found in which taxa, according to which reference? | [https://w.wiki/38Rt](https://w.wiki/38Rt) |
| What are examples of organisms where compounds were reported to be produced by an organism sharing the same parent taxon, but not the organism itself? | [https://w.wiki/3359](https://w.wiki/3359) |
| Which *Zephyranthes* species lack compounds known from at least two sister species? | [https://w.wiki/335x](https://w.wiki/335x) |
| How many compounds are structurally similar to compounds labeled as antibiotics? Results are grouped by the parent taxon of the organism they were found in. | [https://w.wiki/32Qb](https://w.wiki/32Qb) |
| Which compounds are found in a biological organism, according to which references? | [https://w.wiki/335C](https://w.wiki/335C) |
| Which organisms contain indolic scaffold? Results are grouped by the parent taxon and ordered. | [https://w.wiki/32KZ](https://w.wiki/32KZ) |
| How many structure-organism pairs have been referenced by these authors? (Here, two senior natural products chemists and co-authors of this paper are compared to the late Ferdinand Bohlmann). | [https://w.wiki/32$m](https://w.wiki/32$m) |

Table: Example of a given referenced structure-organism pair before and after curation {#tbl:examples}

The queries presented in Table 2 are only selected examples and many other ways to interrogate LOTUS data can be formulated. A combination of these queries can be used, for example, for hypothesis generation when starting a research project.
For instance, a generic SPARQL query - listed in Table 2 as "Which compounds are found in a biological organism, according to which references?" - retrieves all chemical compounds (Q11173) or groups of stereoisomers (Q59199015) with found in taxon (P703) statements supported by a bibliographic reference (Q10358455): https://w.wiki/335C. Data can then be exported in various formats, such as classical tabular formats, json or html tables. At the time of publication, it returned 798,853 entries. A frozen result of the query is available at https://osf.io/xgyhm/. 
Targeted queries allowing to interrogate LOTUS data from the perspective of one of the three objects forming the referenced structure-organism pairs can be also built. Users can, for example, retrieve a list of all reported structures in a given organism (e.g., structures found in Citrus aurantium (Q61127949) https://w.wiki/sFp). Alternatively, all organisms containing a given chemical structure can be queried (e.g., here all organisms in which β-sitosterol (Q121802) was reported https://w.wiki/dFz). For programmatic access, the WikidataLotusExporter repository also allows retrieval in RDF format and as tsv tables. As previously mentioned, some typical queries of molecular DB such as structure or similarity search are not directly available in Wikidata. The SPARQL language does not natively support a simple integration of such queries. To address this issue, Galgonek et al. developed an in-house SPARQL engine that allows utilization of Sachem, their high-performance chemical DB cartridge for PostgreSQL for fingerprint-guided substructure and similarity search (Kratochvíl, 2018). The engine is used by the Integrated Database of Small Molecules (IDSM) that operates, among other things, several dedicated endpoints allowing structural search in selected small-molecule datasets via SPARQL (Kratochvíl et al., 2019). To allow substructure and similarity searches via SPARQL also on compounds from Wikidata, a dedicated IDSM/Sachem endpoint was created for this project. An example of a query containing substructure search is given in Table 2 (https://w.wiki/32KZ). The endpoint indexes isomeric (P2017) and canonical (P233) SMILES code available in Wikidata. To ensure that data are kept up-to-date, SMILES codes are downloaded from Wikidata automatically daily. The endpoint allows users to run federated queries and thus proceed to structure-oriented searches on the LOTUS data hosted at Wikidata. For example, the following SPARQL query, https://w.wiki/32KZ, will return a list of all organisms producing compounds with an indolic scaffold. The list is aggregated at the parent taxa level of the containing organisms and ranked by the number of scaffold occurrences.

##### Lotus.NaturalProducts.Net (LNPN)

In the search field of the LNPN interface, simple queries can be achieved by typing in the molecule name (e.g. protopine) or pasting a SMILES, InChI, InChIKey string, or a Wikidata identifier. All compounds found in a given organism can be found by typing the organism name at the species or any higher taxa level (e.g. Tabernanthe iboga). The compound search by chemical class is also enabled in the same way.
Alternatively, a structure can be directly drawn in the structure search interface (https://lotus.naturalproducts.net/search/structure), where the user can also decide on the nature of the structure search (exact, similarity, substructure search). Refined search mode combining multiple search criteria, in particular physicochemical properties, is available in the advanced search interface (https://lotus.naturalproducts.net/search/advanced).
From LNPN the bulk data can be retrieved as an SDF or SMILES file, or as a complete MongoDB dump via https://lotus.naturalproducts.net/download. Extensive documentation, describing the search possibilities and data entries is available at https://lotus.naturalproducts.net/documentation. LNPN can also be queried programmatically via the API, which is also described in the documentation.

#### Data Addition

One strong advantage of LOTUS consists in the possibility given to users to contribute to the NP occurrences documentation effort by adding new data or editing existing data. As all of the LOTUS data is stored in the SSOT, it is also used to avoid reprocessing of previously treated elements. However, at the moment, the SSOT is not open for direct write access to the public to maintain its coherence and allow us to evolve the scheme. To add or modify data in LOTUS, the users can employ the following approaches.

##### Source Databases

The LOTUS process will regularly re-import both the current source DB and new ones. New and edited information from these DB will be checked against the SSOT and if not present or different, it will follow the curation pipeline and will be further stored into the SSOT. Any researcher can, thus, contribute to these external DB as means of providing new data for LOTUS, keeping in mind the delay between data addition and subsequent inclusion into LOTUS.

##### Wikidata

The currently favored approach to add new data to LOTUS is to edit Wikidata directly. This data will then be automatically imported into the SSOT database. There are several ways to interact with Wikidata which depend on the technical skills of the user and the volume of data to be imported/modified.

###### Manual Upload

Any researcher interested in reporting NP occurrences can manually add the data directly in Wikidata, without any particular technical knowledge requirement. The only prerequisite is to have a Wikidata account and to follow the general object editing guidelines. Regarding the addition of NP-centered objects (i.e., documented structure-organisms pairs) refer to the WikiProject Chemistry/Natural products group page. 
A tutorial for the manual creation and upload to Wikidata of a documented structure-organism pair is available in SI-3. While direct Wikidata upload is possible, contributors are encouraged to use the LOTUS curation pipeline as a preliminary step to strengthen the initial data quality. The added data will therefore benefit from the curation and validation stages implemented in the LOTUS processing pipeline.

###### Batch and Automated Upload

At the end of the previously described initial curation process, more than 500,000 referenced structure-organism pairs were validated for uploading on Wikidata. To automate the Wikidata upload process, a set of programs were written to automatically process the curated outputs, group references, organisms, and compounds, check if they are already present in Wikidata (using SPARQL and direct Wikidata querying), and insert or update the entities as needed (i.e., upserting). These scripts can be used for batch upload of properly curated and referenced structure-organism pairs to Wikidata. ScriptsPrograms for data addition to Wikidata can be found in the repository WikidataLotusImporter. The following Xtools page offers an overview of the latest activity performed by our NPimporterBot, using those programs.
At the end of the previously described initial curation process, more than 500,000 referenced structure-organism pairs were validated for uploading on Wikidata. To automate the Wikidata upload process, a set of programs were written to automatically process the curated outputs, group references, organisms, and compounds, check if they are already present in Wikidata (using SPARQL and direct Wikidata querying), and insert or update the entities as needed (i.e., upserting). These scripts can be used for batch upload of properly curated and referenced structure-organism pairs to Wikidata. ScriptsPrograms for data addition to Wikidata can be found in the repository WikidataLotusImporter. The following Xtools page offers an overview of the latest activity performed by our NPimporterBot, using those programs.

#### Data Edition

Even if correct at a given time point, scientific advances can invalidate or correct previously discovered data. Thus, the possibility to continuously edit the data is desirable and guarantees data quality and sustainability. Community-maintained knowledge bases such as Wikidata encourage such a process. Wikidata presents the advantage of allowing both manual and automated correction. Field-specific robots such as SuccuBot, KrBot, Pi_bot, and ProteinBoxBot or our NPImporterBot went through an approval process. They often do thousands of editions without any need for human input. This helps to reduce automatically the amount of incorrect data that would otherwise require manual editing. However, manual curation by human experts remains the highest standard. Valuing this, interested users are invited to follow the manual curation tutorial in SI-3. The Scholia platform currently does not offer a user-friendly edition interface for scientific references. The adaptation of such a framework to edit the LOTUS documented structure-pairs could facilitate the collection of manual expert curation inputs in the future.

### Data Interpretation

To illustrate the nature and dimensions of the LOTUS dataset some selected examples of data interpretation are shown. First, the distribution of biological organisms according to the number of related chemical structures and likewise the distribution of chemical structures across biological organisms are illustrated (Figure 4). Then individual DB participation to LOTUS data is resumed using the upset plot depiction, which allows the visualization of dataset intersection (Figure 5). In these two previous examples, the cases of β-sitosterol for the chemical structure and of Arabidopsis thaliana for the biological organism, are explored to provide well-documented entries to the reader. Finally, a biologically-interpreted chemical tree and a chemically-interpreted biological tree are presented (Figure 6 and Figure 7). They illustrate the overall chemical and biological coverage of LOTUS by linking family-specific classes of chemical structures to their taxonomic position. Figure 4, Figure 6, and Figure 7 were generated using the frozen data (as of 2021-02-23) available for download at the following link: https://osf.io/hgjdb/. Figure 5 required a dataset containing information from the commercial DB DNP and the complete data used for its generation is therefore unfortunately not available for public distribution. All scripts used for the generation of the figures are available in the lotusProcessor repository in the src/4_visualizing directory for reproducibility purposes.

#### Organisms per Structure and Structure per Organisms Distribution

As depicted in Figure 4, three organisms on average are reported per chemical structure and eleven structures per organism. Half of the structures are reported in only one organism and five structures or fewer are reported in half of the organisms. Metabolomics studies suggest that these numbers are clearly underrated (Noteborn et al., 2000; Wang et al., 2019) and these numbers suggest that a better reporting of the metabolites during a phytochemical investigation could greatly improve coverage. This incomplete coverage may partially be explained by the fact that, usually, only newly described or bioactive structures are accepted for publication in classical NP research journals.

![**Distribution of "structures found in organisms'' and "organisms containing
structures"**. Number of organisms linked to the 2D structure of β-sitosterol (KZJWDPNRJALLNS) and the chemical diversity of Arabidopsis thaliana are highlighted as two notable examples.
](images/distribution.svg "distribution"){#fig:distribution}

#### Individual DB Contribution to LOTUS

The added value of assembling multiple NP DB in LOTUS is illustrated in Figure 5, showing the individual DB contribution to the ensemble of chemical structures found in Arabidopsis thaliana (“Mouse-ear cress”; Q147096) (A) and to the ensemble of taxa containing the two-dimensional structure corresponding to β-sitosterol (Q121802) and (Q63409374) (B), a compound of ubiquitous occurrence in higher plants.

![**Upset plots of the individual DBs
contribution** to 2D structures found in Arabidopsis thaliana (A) and organisms containing the 2D structure of β-sitosterol (KZJWDPNRJALNS) (B). Upset plots are evolved Venn diagrams, allowing to represent intersections between multiple sets. The horizontal bars on the lower left represent the number of corresponding entries per database. The dots and their connecting line represent the intersection between two sets. The vertical bars indicate the number of entries in the intersection. For example, 479 organisms containing the structure of β-sitosterol are present in both UNPD and NAPRALERT, which in turn, respectively report 1164 and 2085 organisms containing the structure of β-sitosterol.
](images/upset_combined.svg "upset"){#fig:upset}

Figure 5 A. shows that the chemical pathways distribution (according to NPClassifier (Kim et al., n.d.) across DB is not conserved. Note that being specially tailored for NP, NPClassifier was preferred over ClassyFire (Feunang et al., 2016) but both chemical taxonomies are available as metadata in the frozen LOTUS export (https://osf.io/hgjdb/) and LNPN. Both classification tools return a chemical taxonomy for individual structures, thus allowing their grouping at higher hierarchical levels, in the same way as it is done for biological taxonomies. This upset plot indicates the poor overlap of preexisting NP DB and the added value of an aggregated dataset. This is also illustrated in Figure 5 B., where the number of organisms for which the 2D structure of β-sitosterol (KZJWDPNRJALLNS) has been reported for each intersection is shown. NAPRALERT has by far the highest number of entries (2085 in total), while other DB complement this well (UNPD, for example, has 532 organisms where β-sitosterol is reported that are not overlapping with the ones reported in NAPRALERT). Interestingly, β-sitosterol is documented in only 3 organisms in the DNP, highlighting the importance of a better systematic reporting of ubiquitous metabolites and the interest of multiple data sources agglomeration.

#### Biologically-interpreted Chemical Tree

LOTUS chemical diversity can be visualized via a TMAP (Figure 6), a visualization method allowing the structural organization of very large chemical datasets as a two-dimensional tree [Probst et al 2020 TMAP]. Using Faerun, an interactive HTML file is generated to display metadata and molecule structures (using the Java-Script library SmilesDrawer) [Probst et al 2018 FUN + Probst et al 2018 SmilesDrawer]. It is to be noticed that planar structures for all compounds (with MAP4 encoding) were used for the TMAP generation since LOTUS contains a mix of planar and 3D structures [Capecchi et al 2020]. As a result, the same planar structure may be present multiple times in the TMAP if this structure was reported with different stereochemistry and/or as a planar structure. Since structures are organized in the tree according to their molecular fingerprint, a good clustering of compounds of the same NPClassifier chemical class can be observed (Figure 6 A.). For clarity reasons, the eight most represented chemical classes of LOTUS plus the quassinoids and unsaturated fatty acids classes are mapped, with an example of a quassinoid (yellow star) and a fatty acid (pink star) with their corresponding location in the TMAP.

![**TMAP visualizations of the chemical diversity present in LOTUS** where each dot corresponds to a chemical structure. Dots are colored according to the NPClassifier chemical class they belong to (A), the most frequently reported biological family (Simaroubaceae or other) (B), and to the specificity of chemical classes to the containing biological organisms (C). A quassinoid (yellow star) and an unsaturated fatty acid (pink star) are mapped as an example in all visualizations. The biological specificity at a given taxonomic level for a given structure is defined as the number of occurrences of the most frequently reported taxon divided by the number of biosources reported. For clarity in the plotting, the average specificity of the structure’s NPClassifier class is displayed and values below 0.8 have been set to 0.8. An average chemical class biological specificity of 1 at the family level means that compounds in that NPClassifier class were only reported in one family. An interactive HTML visualization of the LOTUS TMAP is available at [https://osf.io/kqa8b/](https://osf.io/kqa8b/).
](images/tmap.svg "tmap"){#fig:tmap}

To explore relationships between chemistry and biology, it is possible to map biological information such as the most reported biological family (Figure 6 B.) and the chemical class biological specificity (Figure 6 C.) on the TMAP. These visualizations allow to highlight chemical classes specific to a given taxon, such as the Quassinoids in the Simaroubaceae family example. It is striking to see how well in that case the chemical class (Quassinoids) and the most reported biological family (Simaroubaceae) overlap, highlighting a very specific chemical class (specificity of 0.97 at the biological family level). On the other hand, it is also possible to identify classes that are widely spread among living organisms, such as the unsaturated fatty acids class (specificity of 0.74 at the biological family level).

#### Chemically-interpreted Biological Tree

A summary of the biological and chemical diversity covered by LOTUS is illustrated in Figure 7. To limit biases due to underreporting while keeping a reasonable display size, only families with at least 50 reported structures were kept for this illustration. Organisms were classified according to the OTL taxonomy and structures according to NPClassifier. The tips were labeled according to the biological family and colored according to their biological kingdom. The bars represent structure specificity of the most characteristic chemical class of the given biological family (the higher the more specific), calculated as the square of the number of structures reported in the chemical class within the given family, over the product of the number of reported structures in the chemical class and the number of reported structures in the biological family.

![**Chemical and biological diversity present in
LOTUS**. The tree corresponds to the biological taxonomy, with kingdom as label color. The size of the leaves node corresponds to the number of genera reported in the family. The outer bars correspond to the most specific chemical class found in the biological family. The height of the bar is proportional to a specificity score corresponding to the square of the number of structures reported in the chemical class within the given family, over the product of the number of reported structures in the chemical class with the number of reported structures in the biological family. The bar’s color corresponds to the chemical pathway (NPClassifier classification system) of the most specific chemical class.
](images/magicTree.svg "magicTree"){#fig:magicTree}

In Figure 7, it is possible to spot highly specific compound classes such as trinervitane terpenoids in the Termitidae, rhizoxin macrolides in the Rhizopodaceae, or typical quassinoids and limonoids from the Simaroubaceae and Meliaceae, respectively. More generic tendencies can also be observed. For example, within the fungal kingdom, Basidiomycotina appear to have a higher biosynthetic specificity toward terpenoids than other fungi, which mostly focus on polyketides production. When observed at a finer scale (down to the structure level), such chemotaxonomic representation can give valuable insights. For example, among all chemical structures, only two were found in all biological kingdoms, namely heptadecanoic acid (KEMQGTRYUADPNZ-UHFFFAOYSA-N) and β-carotene (OENHQHLEOONYIE-JLTXGRSLSA-N). Looking at the repartition of the planar β-sitosterol structure (KZJWDPNRJALLNS) within the overall biological taxonomy, SI-4 plots its presence/absence vs those of its two superior chemical classifications, namely the stigmastane and steroid derivatives, over the taxonomic tree used in Figure 7. The comparison of these three chemically-informed taxonomic trees clearly highlights the increasing speciation of the β-sitosterol biosynthetic pathway in the Archaeplastida kingdom, while the superiors triterpene classes were distributed across all kingdoms (see SI-4). As illustrated, the possibility of data interrogation at multiple precision levels (from fully defined 3D structures to broader chemical classes) is of great interest, e.g., for taxonomic and evolution studies.
As shown recently in the context of spectral annotation (Dührkop et al., 2020), lowering the precision level of the annotation allows a broader coverage together with greater confidence. Genetic studies investigating the pathways involved and the organisms carrying the responsible biosynthetic genes responsible would be of interest to confirm the previous observations. These forms of data interpretation exemplify the importance of reporting not only new structures but also novel occurrences of known structures in organisms as comprehensive chemotaxonomic studies are pivotal for a better understanding of the metabolomes of living organisms.

